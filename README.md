# tg-tui

Proposed project for developing a Telegram client for Linux terminal in Python.

Planned Telegram API client:

* <https://github.com/pylakey/aiotdlib>

Planned Terminal UI Framework:

* <https://github.com/Textualize/textual>

Current alternatives:  
<https://github.com/paul-nameless/tg/> - this project seems to have had some activity recently

### 1. Proposed Project Layout

```
telegram‑tui/              # Monorepo root
├── pyproject.toml         # Poetry / PEP 621 metadata, deps, entry points
├── README.md
├── .env.example           # TDLib API_ID / API_HASH template
├── .gitignore
├── tdlib/                 # Source or pre‑built binaries; kept out of PyPI wheel
│   ├── build_tdlib.sh
│   └── README.md
├── src/
│   └── telegram_tui/
│       ├── __init__.py
│       ├── main.py        # `textual run telegram_tui.main:App`
│       ├── config.py      # Loads env vars, XDG paths, logging prefs
│       ├── client/        # TDLib façade
│       │   ├── __init__.py
│       │   ├── session.py     # login, 2FA, state persistence
│       │   ├── handlers.py    # update → internal events
│       │   └── models.py      # Chat, Message dataclasses
│       ├── ui/
│       │   ├── __init__.py
│       │   ├── app.py         # subclass Textual.App
│       │   ├── views/
│       │   │   ├── chat_list.py
│       │   │   ├── chat_view.py
│       │   │   └── modal_auth.py
│       │   └── widgets/
│       │       ├── message_input.py
│       │       ├── status_bar.py
│       │       └── spinner.py
│       ├── services/      # non‑UI helpers
│       │   ├── media_cache.py
│       │   └── notifications.py
│       ├── utils/
│       │   ├── logging.py
│       │   └── theming.py
│       └── _version.py    # auto‑generated by setuptools‑scm
├── tests/
│   ├── __init__.py
│   ├── test_session.py
│   ├── test_models.py
│   └── test_ui.py
├── docs/
│   ├── index.md
│   ├── architecture.md
│   └── contributing.md
└── scripts/
    ├── gen_docs.py
    └── release.py
```

### 2. Development Roadmap

| Phase                                   | Scope                    | Key Deliverables                                                                                                                                                                                               |
| --------------------------------------- | ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **0 — Prep**                 | *Research & scaffolding* | • Decide between `python-telegram` vs `aiotdlib`.<br>• Set up Poetry/ruff/pre‑commit.<br>• Dockerfile or Nix flake for reproducible TDLib build.<br>• GitHub CI matrix (Linux/macOS/Windows).                  |
| **1 — Core Plumbing**        | *Connect & authenticate* | • `session.py` that wraps TDLib auth flow (QR‑code & 2FA).<br>• Event bus that converts TDLib JSON updates → `asyncio.Queue`.<br>• Thin Textual stub window (“Connected!”).                                    |
| **2 — Messaging MVP**        | *Text chat*              | • Chat list panel with lazy paging.<br>• Chat viewport with infinite scroll‑back.<br>• Message composer (plain text, emoji).<br>• Basic outgoing / incoming message sync.                                      |
| **3 — Polish & Media**       | *Quality of life*        | • Message reactions, edited/deleted indicators.<br>• Download & display image captions (thumbnail ASCII placeholder).<br>• Unread counters, typing indicators.<br>• Theme switcher (light/dark/high‑contrast). |
| **4 — Power‑User Features** | *Advanced*               | • Global search (`/` key), per‑chat search (`s`).<br>• Multi‑account switching.<br>• SOCKS5 / MTProto proxy settings UI.                                                                                       |
| **5 — Testing & Docs**        | *Hardening*              | • > 80 % coverage on pure‑Python modules.<br>• Snapshot tests for Textual widgets via `pytest‑textual`.<br>• “Getting Started” guide & dev‑container.json.                                                     |
| **6 — Packaging & Launch**    | *Distribution*           | • Tagged 0.1.0 on PyPI (`pip install telegram-tui`).<br>• Homebrew / AUR formula.<br>• Blog‑post demo GIFs.                                                                                                    |

---

### 3. Early Technical Decisions

| Decision                | Recommendation                                                                                                                                                                      |                                                                         |
| ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| **Async runtime**       | Stick with **Textual’s built‑in asyncio loop**. Off‑load CPU‑heavy TDLib JSON parsing to a `ThreadPoolExecutor` if benchmarks show jank.                                            |                                                                         |
| **State storage**       | Use **SQLite (via `aiosqlite`)** in `$XDG_DATA_HOME/telegram‑tui/` for message/cache persistence; TDLib can also manage its own DB—choose one source of truth to avoid duplication. |                                                                         |
| **Cryptography**        | TDLib already handles MTProto encryption. No need to touch raw crypto.                                                                                                              |                                                                         |
| **Logging & telemetry** | `rich.logging` to stderr; optional Sentry integration gated behind an opt‑in env var.                                                                                               |                                                                         |
| **CI/CD**               | GitHub Actions                                                                                                                                                                      | build wheels (manylinux, macOS, Windows), run unit/UI tests under xvfb. |

---
